<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="Cache-Control" content="no-cache, must-revalidate">
    <meta http-equiv="expires" content="0">
    <title set-lan="html:Title">StockConfig View</title>
    <meta charset="utf-8">
    <meta name="author" content="fgg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="../../css/plugins/bootstrap/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="../../css/plugins/font-awesome/font-awesome.css?v=4.4.0" rel="stylesheet">
    <link href="../../css/animate.css" rel="stylesheet">
    <link href="../../css/style.css?v=4.1.0" rel="stylesheet">
    <link href="../../css/plugins/jQueryUI/jquery-ui.min.css" rel="stylesheet" />
    <link href="../../css/plugins/sweetalert/sweetalert.css" rel="stylesheet" />
    <link href="../../css/plugins/bootstrapTable/bootstrap-table.min.css" rel="stylesheet" />
    <link href="../../css/plugins/bootstrapDateTimePicker/bootstrap-datetimepicker.min.css" rel="stylesheet" />
    <style type="text/css">
        #divConfigView, #AlertMessage {
            display: none;
        }

        .div-table-tool {
            float: left;
            padding: 0px;
            margin: 0px;
        }

        #toolbar .btn:last-child {
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }
    </style>
</head>
<body class="gray-bg">
    <div class="wrapper wrapper-content  animated fadeInRight">
        <div class="panel-heading bg-primary">
            <h3><i class="glyphicon glyphicon-tags"><lan set-lan="html:StockConfigView" style="padding-left:10px;" id="titleName">StockConfig</lan></i></h3>
        </div>
        <div class="ibox-content">
            <div id="divStockView">
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                        <div class="form-group">
                            <div class="col-xs-5   col-sm-6  col-md-5  col-lg-4 col-xs-offset-2">
                                <input type="text" set-lan="attr:placeholder=PlaceholderSearchContent" class="form-control" id="inputSearch">
                            </div>
                            <div class="col-xs-3   col-sm-2 col-md-2  col-lg-1">
                                <button class="btn btn-primary" id="buttonSearch"><i class="fa fa-search"><lan set-lan="html:Search">Search</lan></i></button>
                            </div>
                        </div>
                    </div>
                </div>
                <p></p>
                <div class="row">
                    <div class="bootstrap-table">
                        <div class="fixed-table-toolbar">
                            <div class="btn-group div-table-tool" id="toolbar" role="group">
                                <button type="button" class="btn btn-outline btn-default" id="buttonRefresh">
                                    <i class="glyphicon glyphicon-refresh" aria-hidden="true"></i><lan set-lan="html:refresh">Refresh</lan>
                                </button>
                                <button type="button" class="btn btn-outline btn-default" id="buttonAdd">
                                    <i class="glyphicon glyphicon-plus" aria-hidden="true"></i><lan set-lan="html:add">Add</lan>
                                </button>
                                <button type="button" class="btn btn-outline btn-default" id="buttonDelete">
                                    <i class="glyphicon glyphicon-trash" aria-hidden="true"></i><lan set-lan="html:delete">Delete</lan>
                                </button>
                                <button type="button" class="btn btn-outline btn-default" id="buttonUpload">
                                    <i class="glyphicon glyphicon-upload" aria-hidden="true"></i><lan set-lan="html:upload">Upload</lan>
                                </button>
                                <button type="button" class="btn btn-outline btn-default" onclick="javascript: window.location = '../../File/Upload Stock Excel.xlsx'">
                                    <i class="glyphicon glyphicon-download" aria-hidden="true"></i><lan set-lan="html:template">Template File</lan>
                                </button>
                            </div>
                        </div>
                        <table class="table table-hover" id="tableStock"></table>
                    </div>
                </div>
            </div>
            <div id="divConfigView">
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" style="margin-bottom: 10px;margin-top: -10px;">
                        <!--<button type="button" class="btn btn-primary" id="buttonBack"><i class="fa fa-step-backward"></i> <lan set-lan="html:back">返回</lan></button>-->
                        <button type="button" class="btn btn-primary" id="buttonBack"><i class="fa fa-step-backward"></i> <lan set-lan="html:back">Go Back</lan></button>
                    </div>
                </div>
                <div class="row">
                    <form role="form" class="form-horizontal m-t">
                        <div class="col-sm-12">
                            <div class="form-group draggable" id="divSection">
                                <label class="col-sm-5 control-label" set-lan="html:Section">Section：</label>
                                <div class="col-sm-3">
                                    <input class="form-control" name="SECTION" id="inputSection" set-lan="attr:placeholder=PlaceholderSection">
                                </div>
                                <div class="col-sm-4">
                                    <label class="control-label"></label>
                                </div>
                            </div>
                            <div class="form-group draggable" id="divLocation">
                                <label class="col-sm-5 control-label" set-lan="html:Location">Location：</label>
                                <div class="col-sm-3 ">
                                    <input type="text" class="form-control" id="inputLocation" set-lan="attr:placeholder=PlaceholderLocation" />
                                </div>
                                <div class="col-sm-4">
                                    <label class="control-label" id="labelMessage"></label>
                                </div>
                            </div>
                        </div>
                        <div class="hr-line-dashed col-sm-9"></div>
                        <div class="form-group draggable">
                            <div class="col-sm-12 col-sm-offset-5 col-xs-offset-5">
                                <!--<button type="button" class="btn btn-primary" id="buttonSave"><i class="fa fa-save" set-lan="html:save">保存信息</i></button>-->
                                <button type="button" class="btn btn-primary" id="buttonSave"><i class="fa fa-save" set-lan="html:save">Save</i></button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div id="divUploadInfo" class="hidden">
        <div class="form-group" style="margin-top:15px;">
            <div class="btn-group hidden-xs m-l-lg" style="padding-right:200px">
                <!--<label class="btn btn-primary " for="inputUploadFile" style="z-index:999;height: 38px;"><lan set-lan="html:upload"> 文件路徑:</lan></label>-->
                <label class="btn btn-primary " for="inputUploadFile" style="z-index:999;height: 38px;"><lan set-lan="html:upload"> File Path:</lan></label>
                <input id="inputUploadFile" type="file" class="btn btn-outline btn-primary file-outline" accept=".xlsx,.xlsm,.xlsb,.xls,.xltx,.xltm,.xlt,.xlam,.xla">
            </div>
        </div>
        <div class="">
            <div id="divExcel" style="padding:0 20px;">
            </div>
        </div>
    </div>
    <!-- 全局js -->
    <script src="../../Scripts/plugins/jquery/jquery.min.js?v=2.1.4"></script>
    <script src="../../Scripts/plugins/jquery/jquery.cookie.js"></script>
    <script src="../../Scripts/plugins/bootstrap/bootstrap.min.js?v=3.3.6"></script>
    <script src="../../Scripts/plugins/JSON/json2.js"></script>
    <!-- 第三方插件 -->
    <script src="../../Scripts/plugins/jquery-ui/jquery-ui.js"></script>
    <script src="../../Scripts/plugins/bootstrapTable/bootstrap-table.min.js"></script>
    <script src="../../Scripts/plugins/bootstrapTable/bootstrap-table-export.min.js"></script>
    <script src="../../Scripts/plugins/bootstrapTable/tableExport.min.js"></script>
    <script src="../../Scripts/plugins/bootstrapTable/bootstrap-table-zh-TW.min.js"></script>
    <script src="../../Scripts/plugins/bootstrapTable/bootstrap-table-zh-CN.min.js"></script>
    <script src="../../Scripts/plugins/sweetalert/sweetalert.min.js"></script>
    <script src="../../Scripts/plugins/layer/layer.min.js"></script>
    <script src="../../Scripts/plugins/excel/xlsx.full.min.js"></script>
    <script src="../../Scripts/plugins/excel/xlsx.core.min.js"></script>
    <script src="../../Scripts/plugins/excel/jquery.tabletojson.js"></script>
    <!--自定義插件-->
    <script src="../../Scripts/global.js"></script>
    <script src="../../Scripts/MesClient.UI.js"></script>
    <script>
        var DataList = [];
        var localelan = "";
        var lan = $.cookie($.MES.CK_LAN_NAME);
        var check = "";
        $(document).ready(function () {
            var mesUI = new MesClientUI(self.parent.client);
            if (lan == "CHINESE") {
                localelan = "zh-CN"
            }
            else if (lan == "CHINESE_TW") {
                localelan = "zh-TW"
            }
            else {
                localelan = "en"
            }

            $("#buttonBack").click(function () {
                ClearAll();
            });
            //搜索框事件
            $("#buttonSearch").click(function () {
                var SValue = $.trim($("#inputSearch").val());
                if (SValue.length < 1) {
                    //MessageAlert("ERROR", " 请输入有效的数据！");
                    MessageAlert("ERROR", " Please input valid data！");
                    return;
                }
                var ClassName = "MESStation.Config.Vertiv.CStockConfig";
                var FunctionName = "GetStockByValue";
                self.parent.client.CallFunction(ClassName, FunctionName, { SearchValue: SValue }, function (e) {
                    if (e.Status == "Pass") {
                        $('#tableStock').bootstrapTable("load", e.Data);
                        return;
                    }
                    else {
                        //MessageAlert("ERROR", "沒有找到對應的數據！");
                        MessageAlert("ERROR", "Unable to find the corresponding data！");
                        return;
                    }
                });
            });
            //清空搜索框返回列表
            $("#inputSearch").change(function () {
                var SValue = $.trim($("#inputSearch").val());
                if (SValue.length < 1) {
                    var ClassName = "MESStation.Config.Vertiv.CStockConfig";
                    var FunctionName = "GetAllStock";
                    self.parent.client.CallFunction(ClassName, FunctionName, {}, function (e) {
                        if (e.Status == "Pass") {
                            $('#tableStock').bootstrapTable("load", e.Data);
                        }
                        else {
                            //MessageAlert("ERROR", "沒有找到對應的數據！");
                            MessageAlert("ERROR", "Unable to find the corresponding data！");

                            return;
                        }
                    });
                }
            });
            $("#inputSearch").keydown(function (event) {
                var SValue = $.trim($("#inputSearch").val());
                if (event.keyCode == 13) {
                    if ($.trim($("#inputSearch").val()).length > 0) {
                        var ClassName = "MESStation.Config.Vertiv.CStockConfig";
                        var FunctionName = "GetStockByValue";
                        self.parent.client.CallFunction(ClassName, FunctionName, { SearchValue: SValue }, function (e) {
                            if (e.Status == "Pass") {
                                $('#tableStock').bootstrapTable("load", e.Data);
                            }
                            else {
                                //MessageAlert("ERROR", "沒有找到對應的數據！");
                                MessageAlert("ERROR", "Unable to find the corresponding data！");
                                return;
                            }
                        });
                    }
                }
            });
            $("#inputSection").keydown(function (event) {
                if (event.keyCode == 13) {
                    $('#inputLocation').focus();
                }
            });
            $("#inputLocation").change(function () {
                CheckExists();
            });
            $("#inputLocation").keydown(function (event) {
                if (event.keyCode == 13) {
                    CheckExists();
                }
            });
            var showExcel = document.getElementById("divExcel");
            $("#inputUploadFile").change(function (e) {
                $("#divExcel").html("");
                var filename = $("#inputUploadFile").val();
                if ((filename.indexOf(".xlsx") >= 0) || (filename.indexOf(".xlsm") >= 0) || (filename.indexOf(".xlsb") >= 0) || (filename.indexOf(".xls") >= 0) || (filename.indexOf(".xltx") >= 0) || (filename.indexOf(".xltm") >= 0) || (filename.indexOf(".xlt") >= 0) || (filename.indexOf(".xlam") >= 0) || (filename.indexOf(".xla") >= 0)) {
                    var reader = new FileReader();
                    reader.readAsArrayBuffer(e.target.files[0]);
                    reader.onload = function (e, callback) {
                        var data = new Uint8Array(reader.result);
                        var wb = XLSX.read(data, { type: 'array' });
                        var shitname = wb.SheetNames;
                        showExcel.innerHTML = "";
                        wb.SheetNames.forEach(function (sheetName) {
                            //var htmlstr = XLSX.write(wb, { sheet: shitname[0], type: 'binary', bookType: 'html' }); //binary為二進制方式，會導致中文亂碼
                            var htmlstr = XLSX.write(wb, { sheet: shitname[0], type: 'string', bookType: 'html' });
                            showExcel.innerHTML += htmlstr;
                        });
                        $("#divExcel").find("td").each(function () { $(this).text($(this).text().trim()); });
                        for (var i = 0; i < $("#divExcel").children("table").length; i++) {
                            $("#divExcel").children("table").eq(i).addClass("hidden");
                        }
                        $("#divExcel").children("table").eq(0).removeClass("hidden").addClass("table table-bordered table-hover");
                        $("#divExcel").children("table").eq(0).css("text-align", "center");
                        $("#divExcel").children("table").eq(0).attr({
                            "data-toggle": "table",
                            "data-classes": "table table-hover",
                            "data-height": "355"
                        });
                    }
                }
                else {
                    alert('Please select excel file with xlsx/xlsm/xlsb/xls/xltx/xltm/xlt/xlam/xla formats');
                }
            });
            //增加按钮事件
            $("#buttonRefresh").click(function () {
                window.location.reload();
            });
            $("#buttonAdd").click(function () {
                $("#divStockView").hide();
                $("#divConfigView").show();
                $('#inputSection').focus();
                $("#titleName").removeAttr('set-lan').attr('set-lan', 'html:AddStock');
                $("#divLocation").attr("class", "form-group draggable");
                $("#labelMessage").html("");
                check = "ADD";
                mesUI.SetLanguage("StockConfigPage");

                var data = [];
                data.push("SI");
                data.push("KIT");
                data.push("WHS");
                $("#divSection input[name=SECTION]").autocomplete({
                    minLength: 0,
                    source: data,
                    select: function (event, ui) {
                        $(this).val(ui.item.value);
                    },
                    create: function (event, ui) {
                        $(this).bind("click", function () {
                            var active = $(this).attr("autocomplete");
                            if (active == "off") {
                                $(this).autocomplete("search", "");
                            }
                        });
                    },
                    scroll: true,
                    scrollHeight: 180,
                    position: { my: "right top", at: "right bottom" }
                });
            });
            $("#buttonDelete").click(function () {
                var selectRows = $("#tableStock").bootstrapTable('getSelections');
                if (selectRows.length < 1) {
                    //MessageAlert("ERROR", "最少选中一行进行删除操作！");
                    MessageAlert("ERROR", "Please choose at least one row data to delete ！");
                    return;
                }
                else {
                    swal({
                        //title: "您确定要删除这" + selectRows.length + "条信息吗？",
                        title: "Are you sure to delete " + selectRows.length + "row data ？",
                        //text: "删除后将无法恢复，请谨慎操作！",
                        text: "Unable to restore when you deleted",
                        type: "warning",
                        showCancelButton: true,
                        confirmButtonColor: "#DD6B55",
                        confirmButtonText: "Delete",
                        closeOnConfirm: false
                    }, function () {
                        var ClassName = "MESStation.Config.Vertiv.CStockConfig";
                        var FunctionName = "DeleteStockById";
                        var selectIds = "";
                        for (var i = 0; i < selectRows.length; i++) {
                            selectIds += selectRows[i].ID + ",";
                        }
                        self.parent.client.CallFunction(ClassName, FunctionName, { Ids: selectIds.substring(0, selectIds.length - 1) }, function (e) {
                            if (e.Status == "Pass") {
                                //MessageAlert("OK", "刪除成功！");
                                MessageAlert("OK", "Delete OK！");
                                ClearAll();
                                return;
                            }
                            else {
                                //MessageAlert("ERROR", "沒有找到對應的數據！");
                                MessageAlert("ERROR", "Unable to find the corresponding data！");
                                return;
                            }
                        });
                    });
                }
            });
            $("#buttonUpload").click(function (e) {
                layer.open({
                    id: "UploadData",
                    type: 1,
                    shade: 0.8,
                    shadeClose: false,
                    //title: "上傳儲位信息",
                    title: "Upload Storge Location",
                    area: ['80%', '80%'],
                    content: $('#divUploadInfo'),
                    //btn: ["上傳", "取消"],
                    btn: ["Upload", "Cancel"],
                    success: function (layero, index) {
                        $("#divUploadInfo").removeClass("hidden");
                    },
                    end: function () {
                        $("#divUploadInfo").addClass("hidden");
                    },
                    yes: function (index) {
                        var loadIndex = layer.load(1, {
                            shade: [0.5, 'gray'],
                            content: "<div style='padding: 20px 10px;width: 300px;background-color:#ffffff;border:1px solid #ffffff;margin-left: -150px;border-radius: 5px;'>"
                                + "<div class='layui-layer-loading2' style='padding-left: 40px;height: auto;width: auto;'>"
                                + "<span> Uploading Excel...</span></div></div>"
                        });
                        var DataList = $("#divExcel").children("table").eq(0).tableToJSON(); // Convert the table into a javascript object
                        parent.client.CallFunction("MESStation.Config.Vertiv.CStockConfig", "UploadStockConfig", { DataList: JSON.stringify(DataList) }, function (e) {
                            if (e.Status == "Pass") {
                                layer.close(index);
                                layer.close(loadIndex);
                                $("#divExcel").html("");
                                $("#inputUploadFile").val("");
                                MessageAlert("OK", e.Message);
                            } else {
                                layer.close(index);
                                layer.close(loadIndex);
                                MessageAlert("ERROR", e.Message);
                            }
                        });
                    },
                    cancel: function (index) {
                        $("#inputUploadFile").val("");
                        layer.close(index);
                    }
                });
            });
            //Add点击SAVE触发事件
            $("#buttonSave").click(function () {
                var section = $.trim($("#inputSection").val().toUpperCase());
                var location = $.trim($("#inputLocation").val().toUpperCase());
                if (section.length < 1) {
                    return;
                }
                if (location.length < 3) {
                    //MessageAlert("ERROR", "请重新输入, 儲位至少3個字符以上！");
                    MessageAlert("ERROR", "Please input again , length of storge location at least 3 character !");
                    return;
                }

                if (check == "ADD") {
                    swal({
                        //title: "你确定要增加" + location + "这個儲位？",
                        title: "Are you sure to add the storge location of " + location ,
                        //text: "数据无价，请谨慎操作！",
                        text: "Precious Data,be careful of to operate ",
                        type: "warning",
                        showCancelButton: true,
                        confirmButtonColor: "#f8bb86",
                        confirmButtonText: "Insert",
                        closeOnConfirm: false
                    }, function () {
                        var ClassName = "MESStation.Config.Vertiv.CStockConfig";
                        var FunctionName = "AddNewStockConfig";
                        self.parent.client.CallFunction(ClassName, FunctionName, { Section: section, Location: location }, function (e) {
                            if (e.Status == "Pass") {
                                //MessageAlert("OK", "你操作的数据已更新成功！");
                                MessageAlert("OK", "The data you edit is updated successfully !");
                                $("#inputSection").val("");
                                $("#inputLocation").val("");
                                return;
                            }
                            else {
                                //MessageAlert("ERROR", "更新失敗，請稍後重試！！");
                                MessageAlert("ERROR", "Fail , Please try again later !");
                                return;
                            }
                        });
                    });
                }
                else {
                    var Selections = $("#tableStock").bootstrapTable('getSelections');
                    var ClassName = "MESStation.Config.Vertiv.CStockConfig";
                    var FunctionName = "GetErrorCodeById";
                    self.parent.client.CallFunction(ClassName, FunctionName, { Id: Selections[0].ID }, function (e) {
                        if (e.Status == "Pass") {
                            if (Cdescription == e.Data.CHINESE_DESCRIPTION && section == e.Data.ENGLISH_DESCRIPTION) {
                                //MessageAlert("ERROR", "請修改內容再進行提交！！");
                                MessageAlert("ERROR", "Please edit before you submit !");
                                return;
                            }
                            else {
                                swal({
                                    //title: "你确定要修改" + location + "的信息吗",
                                    title: "Are you sure to change the data of " + location ,
                                    //text: "数据无价，请谨慎操作！",
                                    text: "Precious Data,be careful of to operate ",
                                    type: "warning",
                                    showCancelButton: true,
                                    confirmButtonColor: "#1ab394",
                                    confirmButtonText: "Modify",
                                    closeOnConfirm: false
                                }, function () {
                                    var ClassName = "MESStation.Config.Vertiv.CStockConfig";
                                    var FunctionName = "UpdateErrorCodeById";
                                    self.parent.client.CallFunction(ClassName, FunctionName, { Id: Selections[0].ID, ErrorCode: location, EnglishDescription: section, ChineseDescription: Cdescription, ErrorCategory: Errorcategory }, function (e) {
                                        if (e.Status == "Pass") {
                                            //MessageAlert("OK", "你操作的数据已更新成功！");
                                            MessageAlert("OK", "The data you edit is updated successfully !");
                                            ClearAll();
                                            return;
                                        }
                                        else {
                                            //MessageAlert("ERROR", "沒有找到對應的數據！");
                                            MessageAlert("ERROR", "Unable to find the corresponding data！");
                                            return;
                                        }
                                    });
                                });
                            }
                        }
                        else {
                            //MessageAlert("ERROR", "沒有找到對應的數據！");
                            MessageAlert("ERROR", "Unable to find the corresponding data！");
                            return;
                        }
                    });
                }
            });

            function LoadData() {
                var ClassName = "MESStation.Config.Vertiv.CStockConfig";
                var FunctionName = "GetAllStock";
                self.parent.client.CallFunction(ClassName, FunctionName, {}, function (e) {
                    if (e.Status == "Pass") {
                        if (e.Data != null) {
                            ShowTable(e.Data, "#tableStock");
                            //去掉導出數據按鈕的左上左下圓角
                            $("lan:contains('Export Data')").parent().css({ 'border-top-left-radius': '0', 'border-bottom-left-radius': '0' });
                        }
                    }
                    else {
                        //MessageAlert("ERROR", "沒有找到對應的數據！");
                        MessageAlert("ERROR", "Unable to find the corresponding data！");
                        return;
                    }
                });
                mesUI.SetLanguage("StockConfigPage");
            }
            function ClearAll() {
                var ClassName = "MESStation.Config.Vertiv.CStockConfig";
                var FunctionName = "GetAllStock";
                self.parent.client.CallFunction(ClassName, FunctionName, {}, function (e) {
                    if (e.Status == "Pass") {
                        $("#divStockView").show();
                        $("#divConfigView").hide();
                        $("#titleName").removeAttr('set-lan').attr('set-lan', 'html:StockConfigView');
                        $('#tableStock').bootstrapTable("load", e.Data);
                        $("#inputSection").val("");
                        $("#inputLocation").val("");
                        mesUI.SetLanguage("StockConfigPage");
                    }
                })
            }
            function CheckExists() {
                var section = $.trim($("#inputSection").val().toUpperCase());
                var location = $.trim($("#inputLocation").val().toUpperCase());
                if (location.length > 0) {
                    var ClassName = "MESStation.Config.Vertiv.CStockConfig";
                    var FunctionName = "GetStockByValues";
                    self.parent.client.CallFunction(ClassName, FunctionName, { Section: section, Location: location }, function (e) {
                        if (e.Status == "Pass") {
                            //$("#labelMessage").html("* 输入的 " + section + "|" + location + " 在系统中已存在！");
                            $("#labelMessage").html("The data :  " + section + "|" + location + " you input already exists !");
                            $("#divLocation").attr("class", "form-group draggable has-error");
                            $("#inputLocation").val("");
                            $('#inputLocation').focus();
                            return;
                        }
                        else {
                            $('#buttonSave').focus();
                            $("#labelMessage").html("");
                            $("#divLocation").attr("class", "form-group draggable");
                            return;
                        }
                    });
                }
                else {
                    $("#labelMessage").html("");
                    $("#divLocation").attr("class", "form-group draggable");
                    return;
                }
            }
            //創建表格
            function ShowTable(Data, TableName) {
                var columns = [];
                columns.push({ title: 'checkall', field: 'checkall', checkbox: true, align: 'center' });
                for (var item in Data[0]) {
                    columns.push({ field: item, title: item });
                }
                $(TableName).bootstrapTable({
                    data: Data,
                    striped: false,                    //是否显示行间隔色
                    cache: false,                      //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
                    sortable: false,                   //是否启用排序
                    sortOrder: "asc",                  //排序方式
                    pagination: true,                  //是否显示分页（*）
                    sidePagination: "client",          //分页方式：client客户端分页，server服务端分页（*）
                    pageNumber: 1,                     //初始化加载第一页，默认第一页
                    pageSize: 10,                       //每页的记录行数（*）
                    pageList: [10, 30, 50, 100],        //可供选择的每页的行数（*）
                    showColumns: false,                 //是否显示 内容列下拉框
                    showRefresh: false,                 //是否显示刷新按钮
                    minimumCountColumns: 2,            //最少允许的列数
                    clickToSelect: true,               //是否启用点击选中行
                    singleSelect: false,                //单选checkbox
                    showToggle: false,                  //是否显示详细视图和列表视图的切换按钮
                    cardView: false,                   //是否显示详细视图
                    detailView: false,                 //是否显示父子表
                    search: false,                      //是否显示表格搜索，此搜索是客户端搜索，不会进服务端，
                    strictSearch: false,               //设置为 true启用 全匹配搜索，否则为模糊搜索
                    searchOnEnterKey: false,            //回车搜索
                    searchTimeOut: 500,                //设置搜索超时时间
                    trimOnSearch: true,                //设置为 true 将允许空字符搜索
                    searchAlign: "right",              //查询框对齐方式
                    toolbar: "#toolbar",       //指定工具栏
                    toolbarAlign: "left",              //工具栏对齐方式
                    buttonsAlign: "left",             //按钮对齐方式
                    showExport: true,                  //是否显示导出按钮
                    exportDataType: 'all',             //'basic', 'all', 'selected'  exportDataType表示导出的模式是当前页、所有数据还是选中数据
                    exportTypes: ['excel', 'csv'],     //导出文件类型
                    Icons: 'glyphicon-export',
                    exportOptions: {
                        ignoreColumn: [0],             //忽略某一列的索引
                        fileName: 'StockExcel',     //文件名称设置
                        worksheetName: 'sheet1',       //表格工作区名称
                    },
                    columns: columns,
                    locale: localelan//中文支持,
                });
                $(TableName).bootstrapTable('hideColumn', 'ID');
            }
            //MessageAlert
            function MessageAlert(MsgType, MsgTitle) {
                if (MsgType == "ERROR") {
                    swal({
                        title: MsgTitle,
                        //text: "温馨提示：数据无价，请谨慎操作！",
                        text: "Precious Data,be careful of to operate ",
                        type: "warning",
                        timer: 5000,
                        showConfirmButton: true
                    });
                    return;
                }
                if (MsgType == "OK") {
                    swal({
                        title: MsgTitle,
                        //text: "温馨提示：数据无价，请谨慎操作！",
                        text: "Precious Data,be careful of to operate ",
                        type: "success",
                        timer: 5000,
                        showConfirmButton: true
                    });
                    return;
                }
            }

            LoadData();
        });
    </script>
</body>
</html>