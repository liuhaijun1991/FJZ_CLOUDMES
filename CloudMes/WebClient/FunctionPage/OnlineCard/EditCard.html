<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="pragma" content="no-cache">
    <meta charset="utf-8">
    <title set-lan="html:Title">New Card</title>
    <link href="../../css/plugins/bootstrap/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="../../css/plugins/bootstrapvalidator/bootstrapValidator.css" rel="stylesheet" />
    <link href="../../css/plugins/sweetalert/sweetalert.css" rel="stylesheet" />
    <link href="../../Scripts/plugins/layui/css/layui.css" rel="stylesheet" />
    <title></title>
    <style>
        .ui-autocomplete {
            display: block;
            z-index: 999999999;
            max-height: 180px;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .loadingBgColor {
            background-color: #393D49;
            opacity: 0.8;
            filter: alpha(opacity=80);
        }

        .legend {
            display: block;
            padding: 0;
            width: auto !important;
            margin-bottom: 0px !important;
            border-bottom: 0px solid #e5e5e5 !important;
        }

        .currentlinehight {
            line-height: 10px !important;
        }

        .currentformcontrol {
            height: 20px !important;
            padding: 1px;
            padding-left: 7px !important;
            font-size: 14px !important;
            color: lightslategray !important;
        }

        textarea {
            color: lightslategray !important;
        }

        .currentlabel {
            font-family: auto !important;
            font-size: 14px !important;
        }
    </style>
</head>
<body class="full-height">
    <div role="form" id="CardStage" style="font-size: 12px !important; width: 96%; font-family: serif" class="form-horizontal col-xs-12">
        <form action="" lay-filter="AddForm">
            <div class="col-xs-12">
                <div class="form-group  col-xs-12" hidden="hidden">
                    <label class="col-xs-4 control-label currentlabel" set-lan="html:ID">ID：</label>
                    <div class="col-xs-8">
                        <input type="text" lay-filter="ID" class="form-control currentformcontrol" name="ID" set-lan="attr:placeholder=id" />
                        <input type="text" lay-filter="ESTATUS" class="form-control currentformcontrol" name="ESTATUS" set-lan="attr:placeholder=id" />
                    </div>
                </div>
                <br />
                <div class="currentlinehight col-xs-12 jumbotron">
                    <div id="Summary">
                        <div class="form-group currentlinehight col-xs-12"><span class="layui-badge layui-bg-green">Summary</span></div><hr class="my-4">
                        <div class="form-group col-xs-4">
                            <label class="col-xs-4 control-label currentlabel" set-lan="html:Skuno">CARNO：</label>
                            <div class="col-xs-8">
                                <input type="text" class="form-control currentformcontrol" name="CARNO" id="CARNO" set-lan="attr:placeholder=skuno" lay-filter="CARNO" readonly />
                            </div>
                        </div>
                        <div class="col-xs-4">
                            <label class="col-xs-4 control-label currentlabel" set-lan="html:Skuno">CARTYPE：</label>
                            <div class="col-xs-8 layui-input-inline">
                                <select class="form-control currentformcontrol" name="CARTYPE" id="CARTYPE" lay-filter="CARTYPE">
                                    <option Value="1">Under FPY Goal</option>
                                    <option Value="2">Over DPPM Goal</option>
                                    <option Value="4">3pcs same failed out of 20 pcs</option>
                                    <option Value="5">OBA reject</option>
                                    <option Value="6">Machine Failed</option>
                                    <option Value="7">Reject by QA Supervisor</option>
                                    <option Value="9">Customer Complain</option>
                                    <option Value="10">CQA reject</option>
                                    <option Value="11">Other</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-xs-4">
                            <label class="col-xs-4 control-label currentlabel" set-lan="html:Skuno">FAIL CODE：</label>
                            <div class="col-xs-8">
                                <select class="form-control currentformcontrol" lay-verify="required" name="BUNAME" id="BUNAME" lay-filter="BUNAME">
                                    <option Value="0">方法問題</option>
                                    <option Value="1">物料問題</option>
                                    <option Value="2">機器問題</option>
                                    <option Value="3">環境問題</option>
                                    <option Value="4">紀律問題</option>
                                    <option Value="5">系統問題</option>
                                    <option Value="6">Change問題</option>
                                    <option Value="7">DFM問題</option>
                                    <option Value="8">ESD問題</option>
                                    <option Value="9">SOP問題</option>
                                    <option Value="10">其它</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group  col-xs-12"><span class="layui-badge layui-bg-green">Problem Description</span></div><hr class="my-4">
                        <div class="form-group  col-xs-12">
                            <label class="col-xs-2 control-label currentlabel" set-lan="html:CARTITLE">CAR Title：</label>
                            <div class="col-xs-10">
                                <input type="text" class="form-control currentformcontrol" name="CARTITLE" id="CARTITLE" set-lan="attr:placeholder=skuno" lay-filter="CARTITLE" />
                            </div>
                        </div>
                        <div class="col-xs-12">
                            <div class="form-group col-xs-4">
                                <label class="col-xs-6 control-label currentlabel" set-lan="html:SkunoName">Affected Sku Name:*</label>
                                <div class="col-xs-6">
                                    <input type="text" class="form-control currentformcontrol" name="SKUNAME" id="SKUNAME" set-lan="attr:placeholder=skuno" lay-filter="SKUNAME" />
                                </div>
                            </div>
                            <div class="form-group col-xs-4">
                                <label class="col-xs-6 control-label currentlabel" set-lan="html:Skuno">Affected Sku NO:*</label>
                                <div class="col-xs-6">
                                    <input type="text" class="form-control currentformcontrol" name="SKUNO" id="SKUNO" set-lan="attr:placeholder=CARTYPE" lay-filter="SKUNO" />
                                </div>
                            </div>
                        </div>
                        <div class=" col-xs-12">
                            <div class="form-group col-xs-4">
                                <label class="col-xs-6 control-label currentlabel" set-lan="html:STATION">Affected Station:*</label>
                                <div class="col-xs-6">
                                    <input type="text" class="form-control currentformcontrol" name="STATION" id="STATION" lay-filter="STATION" set-lan="attr:placeholder=skuno" />
                                </div>
                            </div>
                            <div class="form-group col-xs-4">
                                <label class="col-xs-6 control-label currentlabel" set-lan="html:Skuno">Affected Prod. Line:*</label>
                                <div class="col-xs-6">
                                    <input type="text" class="form-control currentformcontrol" name="PRODUCTIONLINE" id="PRODUCTIONLINE" lay-filter="PRODUCTIONLINE" set-lan="attr:placeholder=CARTYPE" />
                                </div>
                            </div>

                            <div class="form-group col-xs-4">
                                <label class="col-xs-6 control-label currentlabel" set-lan="html:Skuno">Time To Happen:*</label>
                                <div class="col-xs-6">
                                    <input type="text" class="form-control currentformcontrol" name="FINDTIME" id="FINDTIME" lay-filter="FINDTIME" set-lan="attr:placeholder=CARTYPE" readonly />
                                </div>
                            </div>
                        </div>
                        <div class=" col-xs-12">
                            <div class="form-group col-xs-4">
                                <label class="col-xs-6 control-label currentlabel" set-lan="html:Skuno">Total Product Qty:*</label>
                                <div class="col-xs-6">
                                    <input type="text" class="form-control currentformcontrol" name="SKUQTY" id="SKUQTY" lay-filter="SKUQTY" set-lan="attr:placeholder=skuno" />
                                </div>
                            </div>
                            <div class="form-group col-xs-4">
                                <label class="col-xs-6 control-label currentlabel" set-lan="html:Skuno"> Total Fail Qty:*</label>
                                <div class="col-xs-6">
                                    <input type="text" class="form-control currentformcontrol" name="FAILQTY" id="FAILQTY" lay-filter="FAILQTY" set-lan="attr:placeholder=CARTYPE" />
                                </div>
                            </div>

                            <div class="form-group col-xs-4">
                                <label class="col-xs-6 control-label currentlabel" set-lan="html:Skuno"> TO:</label>
                                <div class="col-xs-6">
                                    <input type="text" class="form-control currentformcontrol" name="TOTIME" id="TOTIME" lay-filter="TOTIME" set-lan="attr:placeholder=CARTYPE" readonly />
                                </div>
                            </div>
                        </div>


                        <div class="col-xs-12">
                            <div class="form-group  col-xs-8">
                                <label class="col-xs-3 control-label currentlabel" style="padding-right:25px!important" set-lan="html:Type">Failure Description:</label>
                                <div class="col-xs-9" style="padding-left:6px!important">
                                    <textarea class="form-control" id="FAILTEXT" name="FAILTEXT" rows="2" style="min-width: 90%" lay-filter="FAILTEXT"></textarea>
                                </div>
                            </div>
                            <div class="form-group  col-xs-4">
                                <label class="col-xs-5 control-label currentlabel" set-lan="html:Skuno">Attachfile:</label>
                                <div id="uploadfile" class="col-xs-7">
                                    <input type="file" class="btn btn-outline btn-primary file-outline currentformcontrol" style="height: 25px !important;" name="FileUpload" id="FileUpload" lay-filter="FileUpload" set-lan="attr:placeholder=CARTYPE" readonly />
                                    <button type="button" class="btn btn-outline filebtn" lay-filter="ATTACHFILE1">
                                        <i class="glyphicon glyphicon-download-alt" aria-hidden="true"></i><lan set-lan="html:Download"></lan>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-12">
                            <div class="form-group  col-xs-4">
                            </div>
                            <div class="form-group  col-xs-4">
                                <label class="col-xs-6 control-label currentlabel" set-lan="html:Skuno">Confirm By PQE:</label>
                                <div class="col-xs-6">
                                    <input type="text" class="form-control currentformcontrol" name="FAILPNAME" id="FAILPNAME" set-lan="attr:placeholder=skuno" lay-filter="FAILPNAME" />
                                </div>
                            </div>
                            <div class="form-group  col-xs-4">
                                <label class="col-xs-6 control-label currentlabel" set-lan="html:Skuno">ConfirmDate:</label>
                                <div class="col-xs-6">
                                    <input type="text" class="form-control currentformcontrol" name="ISSUEDATE" id="ISSUEDATE" lay-filter="ISSUEDATE" set-lan="attr:placeholder=CARTYPE" readonly />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="PqeConfirm">
                        <div class="form-group  col-xs-12"><span class="layui-badge layui-bg-green">Pqe Confirm</span></div><hr class="my-4">
                        <div class="col-xs-12">
                            <div class="form-group col-xs-4">
                                <label class="col-xs-6 control-label currentlabel" set-lan="html:Skuno">OK To Release:</label>
                                <div class="col-xs-6">
                                    <div class="radio">
                                        <label>
                                            <input type="radio" value="1" name="OKTORELEASE" data-title="Accept" lay-filter="OKTORELEASE" /> Accept
                                        </label>
                                        <label>
                                            <input type="radio" value="2" name="OKTORELEASE" data-title="Reject" lay-filter="OKTORELEASE" /> Reject
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group col-xs-8">
                                <label class="form-group col-xs-3 control-label currentlabel" style="padding-right:10px;" set-lan="html:Skuno">FA Resp. Depart:</label>
                                <div class="form-group col-xs-9" style="padding-left:50px;">
                                    <div class="radio">
                                        <label>
                                            <input type="radio" value="ME" name="FAILDEPART" lay-filter="FAILDEPART" data-title="ME" /> ME
                                        </label>
                                        <label>
                                            <input type="radio" value="TE" name="FAILDEPART" lay-filter="FAILDEPART" data-title="TE" /> TE
                                        </label>
                                        <label>
                                            <input type="radio" value="Prod" name="FAILDEPART" lay-filter="FAILDEPART" data-title="Prod" /> Prod
                                        </label>
                                        <label>
                                            <input type="radio" value="PQE" name="FAILDEPART" lay-filter="FAILDEPART" data-title="PQE" /> PQE
                                        </label>
                                        <label>
                                            <input type="radio" value="PE" name="FAILDEPART" lay-filter="FAILDEPART" data-title="PE" /> PE
                                        </label>
                                        <label>
                                            <input type="radio" value="SE" name="FAILDEPART" lay-filter="FAILDEPART" data-title="SE" /> SE
                                        </label>
                                        <label>
                                            <input type="radio" value="Repair" name="FAILDEPART" lay-filter="FAILDEPART" data-title="Repair" /> Repair
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-12">
                            <div class="form-group col-xs-4"></div>
                            <div class="form-group col-xs-4">
                                <label class="col-xs-6 control-label  currentlabel" set-lan="html:Skuno">Confirm By:</label>
                                <div class="col-xs-6">
                                    <input type="text" class="form-control currentformcontrol" name="CONFIRMNAME" id="CONFIRMNAME" lay-filter="CONFIRMNAME" set-lan="attr:placeholder=skuno" />
                                </div>
                            </div>
                            <div class="form-group  col-xs-4">
                                <label class="col-xs-6 control-label currentlabel" set-lan="html:Skuno">ConfirmDate:</label>
                                <div class="col-xs-6">
                                    <input type="text" class="form-control currentformcontrol" name="CONFIRMDATE" id="CONFIRMDATE" lay-filter="CONFIRMDATE" set-lan="attr:placeholder=CARTYPE" readonly />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="RootCause">
                        <div class="form-group  col-xs-12"><span class="layui-badge layui-bg-green">Root Cause Analyze And Suggestion</span></div><hr class="my-4">
                        <div class="form-group  col-xs-12">
                            <label class="col-xs-2 control-label currentlabel" set-lan="html:Skuno">CA Resp.Dept:</label>
                            <div class="col-xs-10 checkbox">
                                <label>
                                    <input type="checkbox" value="ME" name="ROOTDEPART" data-title="ME" lay-filter="ROOTDEPART" /> ME
                                </label>
                                <label>
                                    <input type="checkbox" value="TE" name="ROOTDEPART" data-title="TE" lay-filter="ROOTDEPART" /> TE
                                </label>
                                <label>
                                    <input type="checkbox" value="PQE" name="ROOTDEPART" data-title="PQE" lay-filter="ROOTDEPART" /> PQE
                                </label>
                                <label>
                                    <input type="checkbox" value="PE" name="ROOTDEPART" data-title="PE" lay-filter="ROOTDEPART" /> PE
                                </label>
                                <label>
                                    <input type="checkbox" value="SE" name="ROOTDEPART" data-title="SE" lay-filter="ROOTDEPART" /> SE
                                </label>
                                <label>
                                    <input type="checkbox" value="REPAIR" name="ROOTDEPART" data-title="REPAIR" lay-filter="ROOTDEPART" /> REPAIR
                                </label>
                                <label>
                                    <input type="checkbox" value="ICT" name="ROOTDEPART" data-title="ICT" lay-filter="ROOTDEPART" /> ICT
                                </label>
                                <label>
                                    <input type="checkbox" value="CE" name="ROOTDEPART" data-title="CE" lay-filter="ROOTDEPART" /> CE
                                </label>
                                <label>
                                    <input type="checkbox" value="PTH-PROD" name="ROOTDEPART" data-title="PTH-PROD" lay-filter="ROOTDEPART" /> PTH-PROD
                                </label>
                                <label>
                                    <input type="checkbox" value="SI-PROD" name="ROOTDEPART" data-title="SI-PROD" lay-filter="ROOTDEPART" /> SI-PROD
                                </label>
                                <label>
                                    <input type="checkbox" value="IE" name="ROOTDEPART" data-title="IE" lay-filter="ROOTDEPART" /> IE
                                </label>
                                <label>
                                    <input type="checkbox" value="SFC" name="ROOTDEPART" data-title="SFC" lay-filter="ROOTDEPART" /> SFC
                                </label>
                                <label>
                                    <input type="checkbox" value="PM" name="ROOTDEPART" data-title="PM" lay-filter="ROOTDEPART" /> PM
                                </label>
                                <label>
                                    <input type="checkbox" value="IQC" name="ROOTDEPART" data-title="IQC" lay-filter="ROOTDEPART" /> IQC
                                </label>
                                <label>
                                    <input type="checkbox" value="Planning" name="ROOTDEPART" data-title="Planning" lay-filter="ROOTDEPART" /> Planning
                                </label>
                                <label>
                                    <input type="checkbox" value="IPQC" name="ROOTDEPART" data-title="IPQC" lay-filter="ROOTDEPART" /> IPQC
                                </label>
                                <label>
                                    <input type="checkbox" value="SQE" name="ROOTDEPART" data-title="SQE" lay-filter="ROOTDEPART" /> SQE
                                </label>
                                <label>
                                    <input type="checkbox" value="KITTING" name="ROOTDEPART" data-title="KITTING" lay-filter="ROOTDEPART" /> KITTING
                                </label>
                                <label>
                                    <input type="checkbox" value="SMT-PROD" name="ROOTDEPART" data-title="SMT-PROD" lay-filter="ROOTDEPART" /> SMT-PROD
                                </label>
                            </div>
                        </div>
                        <div class="form-group  col-xs-12">
                            <div class="form-group  col-xs-8">
                                <label class="col-xs-3 control-label currentlabel" set-lan="html:Type">Root Cause Analyze And Suggestion:</label>
                                <div class="col-xs-9">
                                    <textarea class="form-control" id="ROOTTEXT" name="ROOTTEXT" rows="2" style="min-width: 90%" lay-filter="ROOTTEXT"></textarea>
                                </div>
                            </div>
                            <div class="form-group  col-xs-4">
                                <label class="col-xs-5 control-label currentlabel" set-lan="html:Skuno">Attachfile:</label>
                                <div id="uploadfile2" class="col-xs-7">
                                    <input type="file" class="btn btn-outline btn-primary file-outline currentformcontrol" style="height: 25px !important;" name="CaFileUpload" id="CaFileUpload" lay-filter="CaFileUpload" set-lan="attr:placeholder=CARTYPE" readonly />
                                    <button type="button" class="btn btn-outline filebtn" lay-filter="ATTACHFILE2">
                                        <i class="glyphicon glyphicon-download-alt" aria-hidden="true"></i><lan set-lan="html:Download"></lan>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="form-group  col-xs-12">
                            <div class="col-xs-12">
                                <div class="form-group  col-xs-4">
                                </div>
                                <div class="form-group  col-xs-4">
                                    <label class="col-xs-6 control-label currentlabel" set-lan="html:Skuno">Prepared By:</label>
                                    <div class="col-xs-6">
                                        <input type="text" class="form-control currentformcontrol" name="ROOTPNAME" id="ROOTPNAME" set-lan="attr:placeholder=skuno" lay-filter="ROOTPNAME" />
                                    </div>
                                </div>
                                <div class="form-group  col-xs-4">
                                    <label class="col-xs-6 control-label currentlabel" set-lan="html:Skuno">FA Date:</label>
                                    <div class="col-xs-6">
                                        <input type="text" class="form-control currentformcontrol" name="FADATE" id="FADATE" lay-filter="FADATE" set-lan="attr:placeholder=CARTYPE" readonly />
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div id="AddDept">
                        <div class="form-group  col-xs-9">
                            <div class="col-xs-6"><span class="layui-badge layui-bg-green">Add Dept</span></div>
                        </div>
                        <div class="form-group  col-xs-3">
                            <i class="layui-icon layui-icon-notice"  style="color: #393D49!important;font-weight:bolder!important"></i><span class="layui-badge layui-bg-gray">:未对应部门用户项目为灰色不可填写</span>
                        </div>
                        <hr class="my-4">
                        <div class="form-group  col-xs-12">
                            <label class="col-xs-2 control-label currentlabel" style="text-align: center !important" set-lan="html:Skuno">CA Dept</label>
                            <label class="col-xs-4 control-label currentlabel" style="text-align: center !important" set-lan="html:Skuno">Corrective Action</label>
                            <label class="col-xs-2 control-label currentlabel" style="text-align: center !important" set-lan="html:Skuno">Due Date</label>
                            <label class="col-xs-2 control-label currentlabel" style="text-align: center !important" set-lan="html:Skuno">Prepared Date</label>
                            <label class="col-xs-2 control-label currentlabel" style="text-align: center !important" set-lan="html:Skuno">Prepared By</label>
                        </div>
                        <div class="col-xs-12" lay-filter="Dept1">
                            <div class=" col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="AUDITDEPART1" id="AUDITDEPART1" lay-filter="AUDITDEPART1" set-lan="attr:placeholder=skuno" readonly />
                                </div>
                            </div>
                            <div class=" col-xs-4">
                                <div class="form-group col-xs-12">
                                    <textarea class="form-control " id="MODIPART1" name="MODIPART1" rows="2" lay-filter="MODIPART1" style="min-width: 90%"></textarea>
                                </div>
                            </div>
                            <div class=" col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="YCOMPLETEDDATE1" id="YCOMPLETEDDATE1" lay-filter="YCOMPLETEDDATE1" set-lan="attr:placeholder=skuno" readonly />
                                </div>
                            </div>
                            <div class=" col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="COMPLETEDDATE1" id="COMPLETEDDATE1" lay-filter="COMPLETEDDATE1" set-lan="attr:placeholder=skuno" readonly />
                                </div>
                            </div>
                            <div class=" col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="AUDITNAME1" id="AUDITNAME1" lay-filter="AUDITNAME1" set-lan="attr:placeholder=skuno" />
                                </div>
                            </div>
                        </div>
                        <div class=" col-xs-12" lay-filter="Dept2">
                            <div class="col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="AUDITDEPART2" id="AUDITDEPART2" lay-filter="AUDITDEPART2" set-lan="attr:placeholder=skuno" readonly />
                                </div>
                            </div>
                            <div class="col-xs-4">
                                <div class="form-group col-xs-12">
                                    <textarea class="form-control " id="MODIPART2" name="MODIPART2" rows="2" style="min-width: 90%" lay-filter="MODIPART2"></textarea>
                                </div>
                            </div>
                            <div class="col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="YCOMPLETEDDATE2" id="YCOMPLETEDDATE2" lay-filter="YCOMPLETEDDATE2" set-lan="attr:placeholder=skuno" readonly />
                                </div>
                            </div>
                            <div class="col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="COMPLETEDATE2" id="COMPLETEDATE2" lay-filter="COMPLETEDATE2" set-lan="attr:placeholder=skuno" readonly />
                                </div>
                            </div>
                            <div class="col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="AUDITNAME2" id="AUDITNAME2" lay-filter="AUDITNAME2" set-lan="attr:placeholder=skuno" />
                                </div>
                            </div>
                        </div>
                        <div class=" col-xs-12" lay-filter="Dept3">
                            <div class="col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="AUDITDEPART3" id="AUDITDEPART3" lay-filter="AUDITDEPART3" set-lan="attr:placeholder=skuno" readonly />
                                </div>
                            </div>
                            <div class="col-xs-4">
                                <div class="form-group col-xs-12">
                                    <textarea class="form-control " id="MODIPART3" name="MODIPART3" rows="2" style="min-width: 90%" lay-filter="MODIPART3"></textarea>
                                </div>
                            </div>
                            <div class="col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="YCOMPLETEDDATE3" id="YCOMPLETEDDATE3" lay-filter="YCOMPLETEDDATE3" set-lan="attr:placeholder=skuno" readonly />
                                </div>
                            </div>
                            <div class="col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="COMPLETEDATE3" id="COMPLETEDATE3" lay-filter="COMPLETEDATE3" set-lan="attr:placeholder=skuno" readonly />
                                </div>
                            </div>
                            <div class="col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="AUDITNAME3" id="AUDITNAME3" lay-filter="AUDITNAME3" set-lan="attr:placeholder=skuno" />
                                </div>
                            </div>
                        </div>
                        <div class=" col-xs-12" lay-filter="Dept4">
                            <div class="col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="AUDITDEPART4" id="AUDITDEPART4" lay-filter="AUDITDEPART4" set-lan="attr:placeholder=skuno" readonly />
                                </div>
                            </div>
                            <div class="col-xs-4">
                                <div class="form-group col-xs-12">
                                    <textarea class="form-control " id="MODIPART4" name="MODIPART4" rows="2" style="min-width: 90%" lay-filter="MODIPART4"></textarea>
                                </div>
                            </div>
                            <div class="col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="YCOMPLETEDDATE4" id="YCOMPLETEDDATE4" lay-filter="YCOMPLETEDDATE4" set-lan="attr:placeholder=skuno" readonly />
                                </div>
                            </div>
                            <div class="col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="COMPLETEDATE4" id="COMPLETEDATE4" lay-filter="COMPLETEDATE4" set-lan="attr:placeholder=skuno" readonly />
                                </div>
                            </div>
                            <div class="col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="AUDITNAME4" id="AUDITNAME4" lay-filter="AUDITNAME4" set-lan="attr:placeholder=skuno" />
                                </div>
                            </div>
                        </div>
                        <div class=" col-xs-12" lay-filter="Dept5">
                            <div class="col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="AUDITDEPART5" id="AUDITDEPART5" lay-filter="AUDITDEPART5" set-lan="attr:placeholder=skuno" readonly />
                                </div>
                            </div>
                            <div class="col-xs-4">
                                <div class="form-group col-xs-12">
                                    <textarea class="form-control " id="MODIPART5" name="MODIPART5" rows="2" style="min-width: 90%" lay-filter="MODIPART5"></textarea>
                                </div>
                            </div>
                            <div class="col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="YCOMPLETEDDATE5" id="YCOMPLETEDDATE5" lay-filter="YCOMPLETEDDATE5" set-lan="attr:placeholder=skuno" readonly />
                                </div>
                            </div>
                            <div class="col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="COMPLETEDATE5" id="COMPLETEDATE5" lay-filter="COMPLETEDATE5" set-lan="attr:placeholder=skuno" readonly />
                                </div>
                            </div>
                            <div class="col-xs-2">
                                <div class="form-group col-xs-12">
                                    <input type="text" class="form-control currentformcontrol" name="AUDITNAME5" id="AUDITNAME5" lay-filter="AUDITNAME5" set-lan="attr:placeholder=skuno" />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="QC">
                        <div class="form-group  col-xs-12"><span class="layui-badge layui-bg-green">QC Verification</span></div><hr class="my-4">
                        <div class="col-xs-12">
                            <div class="form-group  col-xs-8">
                                <label class="col-xs-3 control-label currentlabel" set-lan="html:Type">QC Verification Result:</label>
                                <div class="col-xs-9">
                                    <textarea class="form-control" id="QCFAILPRODPROCESS" name="QCFAILPRODPROCESS" rows="2" lay-filter="QCFAILPRODPROCESS" style="min-width: 90%"></textarea>
                                </div>
                            </div>
                            <div class="form-group  col-xs-4">
                                <label class="col-xs-5 control-label currentlabel" set-lan="html:Skuno">Attachfile:</label>
                                <div id="uploadfile3" class="col-xs-7">
                                    <input type="file" class="btn btn-outline btn-primary file-outline currentformcontrol" style="height: 25px !important;" name="QcFileUpload" id="QcFileUpload" lay-filter="QcFileUpload" set-lan="attr:placeholder=CARTYPE" readonly />
                                    <button type="button" class="btn btn-outline filebtn" lay-filter="ATTACHFILE3">
                                        <i class="glyphicon glyphicon-download-alt" aria-hidden="true"></i><lan set-lan="html:Download"></lan>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class=" col-xs-12">
                            <div class="col-xs-12">
                                <div class="form-group  col-xs-4">
                                </div>
                                <div class="form-group  col-xs-4">
                                    <label class="col-xs-6 control-label currentlabel" set-lan="html:Skuno">Prepared By:</label>
                                    <div class="col-xs-6">
                                        <input type="text" class="form-control currentformcontrol" name="QCPREPAREDBY" id="QCPREPAREDBY" set-lan="attr:placeholder=skuno" lay-filter="QCPREPAREDBY" />
                                    </div>
                                </div>
                                <div class="form-group  col-xs-4">
                                    <label class="col-xs-6 control-label currentlabel" set-lan="html:Skuno">Verification Date:</label>
                                    <div class="col-xs-6">
                                        <input type="text" class="form-control currentformcontrol" name="QCPREPAREDDATE" id="QCPREPAREDDATE" lay-filter="QCPREPAREDDATE" set-lan="attr:placeholder=CARTYPE" readonly />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="QA">
                        <div class="form-group  col-xs-12"><span class="layui-badge layui-bg-green">QA Supervisor Approval</span></div><hr class="my-4">
                        <div class="form-group  col-xs-12">
                            <label class="col-xs-6 control-label currentlabel" set-lan="html:Type">OK To Accept:</label>
                            <div class="col-xs-6">
                                <div class="col-xs-12 radio" lay-filter="PROMIT" id="PROMIT">
                                    <label>
                                        <input type="radio" value="1" name="PROMIT" data-title="ME" lay-filter="PROMIT" /> Yes
                                    </label>
                                    <label>
                                        <input type="radio" value="2" name="PROMIT" data-title="TE" lay-filter="PROMIT" /> No
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="form-group  col-xs-8">
                            <label class="col-xs-3 control-label currentlabel" set-lan="html:Type">Remark :</label>
                            <div class="col-xs-9">
                                <textarea class="form-control" id="REMARK" name="REMARK" lay-filter="REMARK" rows="2" style="min-width: 90%"></textarea>
                            </div>
                        </div>
                        <div class="col-xs-4">
                            <div class="form-group col-xs-12">
                                <label class="col-xs-6 control-label  currentlabel" set-lan="html:Skuno">Approved By:</label>
                                <div class="col-xs-6">
                                    <input type="text" class="form-control currentformcontrol" lay-filter="QAMANAGER" name="QAMANAGER" id="QAMANAGER" set-lan="attr:placeholder=skuno" />
                                </div>
                            </div> -
                            <div class="form-group col-xs-12">
                                <label class="col-xs-6 control-label currentlabel" set-lan="html:Skuno">Approval Date:</label>
                                <div class="col-xs-6">
                                    <input type="text" class="form-control currentformcontrol" name="PROMITDATE" lay-filter="PROMITDATE" id="PROMITDATE" set-lan="attr:placeholder=CARTYPE" readonly />
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group  col-xs-12"><span class="layui-badge layui-bg-green">Edit Info</span></div><hr class="my-4">
                    <div class="form-group  col-xs-12">
                        <label class="col-xs-1 control-label currentlabel" set-lan="html:Type">CREATEBY:</label>
                        <div class="col-xs-2">
                            <input type="text" class="form-control currentformcontrol" name="CREATEBY" lay-filter="CREATEBY" id="CREATEBY" set-lan="attr:placeholder=CREATETIME" readonly />
                        </div>
                        <label class="col-xs-1 control-label currentlabel" set-lan="html:Type">CREATETIME:</label>
                        <div class="col-xs-2">
                            <input type="text" class="form-control currentformcontrol" name="CREATETIME" lay-filter="CREATETIME" id="CREATETIME" set-lan="attr:placeholder=CREATETIME" readonly />
                        </div>
                        <label class="col-xs-1 control-label currentlabel" set-lan="html:Type">EDITBY:</label>
                        <div class="col-xs-2">
                            <input type="text" class="form-control currentformcontrol" name="EDITBY" lay-filter="EDITBY" id="EDITBY" set-lan="attr:placeholder=CREATETIME" readonly />
                        </div>
                        <label class="col-xs-1 control-label currentlabel" set-lan="html:Type">EDITTIME:</label>
                        <div class="col-xs-2">
                            <input type="text" class="form-control currentformcontrol" name="EDITTIME" lay-filter="EDITTIME" id="EDITTIME" set-lan="attr:placeholder=CREATETIME" readonly />
                        </div>
                    </div>
                </div>
                <div class="hr-line-dashed col-xs-12"></div>
                <div class="form-group col-xs-12">
                    <div class="col-xs-12">
                        <button type="submit" class="btn btn-primary btn-block" name="savebtn" id="Save"><i class="fa fa-pencil"></i> <lan set-lan="html:BtnSave">Save information</lan></button>
                    </div>
                </div>
                <!--</fieldset>-->
            </div>
        </form>
    </div>

    <!--Add Extend Config End-->
    <script src="../../Scripts/plugins/layui/layui.js"></script>
    <!-- 全局js -->
    <script src="../../Scripts/plugins/jquery/jquery.min.js?v=2.1.4"></script>
    <script src="../../Scripts/plugins/bootstrap/bootstrap.min.js?v=3.3.6"></script>
    <script src="../../Scripts/plugins/bootstrapvalidator/bootstrapValidator5.js"></script>
    <!--<script src="../../Scripts/plugins/bootstrapvalidator/bootstrapValidator.js"></script>-->
    <!-- 第三方插件 -->
    <script src="../../Scripts/plugins/sweetalert/sweetalert.min.js"></script>
    <script src="../../Scripts/plugins/layer/layer.min.js"></script>
    <script src="../../Scripts/plugins/jquery-base64/jquery.base64.js"></script>
    <script src="../../Scripts/global.js"></script>
    <script src="../../Scripts/MesClient.UI.js"></script>
    <script src="../../Scripts/MesClient.js"></script>
    <script>
        layui.use(['form', 'laydate'], function () {
            var cobj = {
                "PRODUCTIONLINE": "",
                "STATION": "",
                "FINDTIME": "",
                "TOTIME": "",
                "SKUQTY": "",
                "FAILQTY": "",
                "FAILTEXT": "",
                "ATTACHFILE1": "",
                "FAILPNAME": "",
                "ISSUEDATE": "",
                "OKTORELEASE": "",
                "FAILDEPART": "",
                "CONFIRMNAME": "",
                "CONFIRMDATE": "",
                "ROOTDEPART": "",
                "ROOTTEXT": "",
                "PATEXT": "",
                "ATTACHFILE2": "",
                "ROOTPNAME": "",
                "ISCANCEL": "",
                "FADATE": "",
                "AUDITDEPART1": "",
                "AUDITDEPART2": "",
                "AUDITDEPART3": "",
                "AUDITDEPART4": "",
                "AUDITDEPART5": "",
                "MODIPART1": "",
                "MODIPART2": "",
                "MODIPART3": "",
                "MODIPART4": "",
                "MODIPART5": "",
                "YCOMPLETEDDATE1": "",
                "YCOMPLETEDDATE2": "",
                "YCOMPLETEDDATE3": "",
                "YCOMPLETEDDATE4": "",
                "YCOMPLETEDDATE5": "",
                "COMPLETEDDATE1": "",
                "COMPLETEDATE2": "",
                "COMPLETEDATE3": "",
                "COMPLETEDATE4": "",
                "COMPLETEDATE5": "",
                "AUDITNAME1": "",
                "AUDITNAME2": "",
                "AUDITNAME3": "",
                "AUDITNAME4": "",
                "AUDITNAME5": "",
                "LASTEDITDT": "",
                "RETURNREASON": "",
                "QCFAILPRODPROCESS": "",
                "ATTACHFILE3": "",
                "QCPREPAREDBY": "",
                "QCPREPAREDDATE": "",
                "PROMIT": "",
                "PROMITDATE": "",
                "REMARK": "",
                "QAMANAGER": "",
                "ESTATUS": "",
                "ID": "",
                "CARNO": "",
                "CARTYPE": "",
                "CARTITLE": "",
                "BUNAME": "",
                "SKUNAME": "",
                "SKUNO": "",
                "WORKORDERNO": "",
                "CREATETIME": "",
                "CREATEBY": "",
                "EDITTIME": "",
                "EDITBY": ""
            };
            var CurrentUserDet;
            var CacheFileObj = function (savefilename, filename, Bas64File) {
                return {
                    Name: savefilename,
                    FileName: filename,
                    MD5: "",
                    UseType: "OnlineCard",
                    //Bas64File: Bas64File
                    CLOB_FILE: Bas64File
                }
            };
            var attfilelist = [];
            var laydate = layui.laydate;
            var initlaydate = function () {
                var cdates = "FINDTIME,TOTIME,ISSUEDATE,CONFIRMDATE,FADATE,YCOMPLETEDDATE1,YCOMPLETEDDATE2,COMPLETEDATE2,YCOMPLETEDDATE3,COMPLETEDATE3,YCOMPLETEDDATE4,COMPLETEDATE4,YCOMPLETEDDATE5,COMPLETEDATE5,QCPREPAREDDATE,PROMITDATE,COMPLETEDDATE1".split(',');
                for (var i = 0; i < cdates.length; i++) {
                    var col = cdates[i];               
                    setlaydate(col);
                }
            }
            var setlaydate = function (filesc) {
                laydate.render({
                    elem: '#' + filesc, trigger: 'click', done: function (value, date, endDate) {
                        var thiscol = filesc;
                        $('#CardStage').data('bootstrapValidator').updateStatus(thiscol, 'NOT_VALIDATED', null);
                    }
                });
            }
            var loadfromdata = function (obj) {
                for (var k in obj) {//遍历Data 对象的每个key/value对,k为key
                    if ($('[lay-filter=' + k + ']').length === 1 && $('[lay-filter=' + k + ']').attr("type") != "button")
                        obj[k] = $('[lay-filter=' + k + ']').val();
                    else if ("checkbox".indexOf($('[lay-filter=' + k + ']').attr("type")) === 0) {
                        obj[k] = "";
                        for (var i = 0; i < $('input[lay-filter=' + k + ']:checked').length; i++) {
                            obj[k] += $('input[lay-filter=' + k + ']:checked')[i].value;
                        }
                    }
                    else if ($('[lay-filter=' + k + ']').length > 1)
                        obj[k] = $('[lay-filter=' + k + ']:checked').val();
                }
                return obj;
            }
            var loadFormBydata = function (obj) {
                for (var k in obj) {//遍历Data 对象的每个key/value对,k为key
                    if ($('[lay-filter=' + k + ']').attr("type") === "button")
                        $('[lay-filter=' + k + ']').text(obj[k]);
                    else if ($('[lay-filter=' + k + ']').length === 1)
                        $('[lay-filter=' + k + ']').val(obj[k]);
                    else if ("checkbox,radio".indexOf($('[lay-filter=' + k + ']').attr("type")) >= 0) {
                        for (var i = 0; i < $('input[lay-filter=' + k + ']').length; i++) {
                            if (obj[k] != null && obj[k].toString().indexOf($('input[lay-filter=' + k + ']')[i].value) >= 0) {
                                $('input[lay-filter=' + k + ']')[i].checked = true;
                            }
                        }
                    }
                }
            }
            var cachefile = function (e, savefilename, c, callback) {
                var w = new Worker("../../Scripts/Setting/BigFileReader.js");
                w.onmessage = function (e) {
                    layer.closeAll("loading");
                    if (e.data.Status == "Pass") {
                        Bas64File = e.data.Bas64File;
                        for (var i = 0; i < attfilelist.length; i++)
                            if (attfilelist[i].savefilename === savefilename) {
                                attfilelist.slice(i, 1);
                                break;
                            }
                        attfilelist.push(CacheFileObj(savefilename, filename, Bas64File));
                        callback();
                    } else {
                        c.val("");
                        layer.msg(e.data.Message,
                            {
                                icon: 2,
                                time: 3000
                            },
                            function () {
                            });
                    }
                };
                w.onerror = function () {
                    c.val("");
                    layer.msg("Worker Error!",
                        {
                            icon: 2,
                            time: 3000
                        },
                        function () {
                        });
                }
                layer.load(3);
                filename = c.val();
                filename = filename.substring(filename.lastIndexOf("\\") + 1);
                UseType = filename.substring(filename.lastIndexOf(".") + 1).toUpperCase();
                w.postMessage({ file: e.target.files[0], filename: filename, UseType: UseType, ExtName: "" });
            }
            var saveFile = function (callback) {
                parent.client.CallFunction("MESStation.FileUpdate.FileUpload",
                    "UpLoadFileList",
                    {
                        FileObjList: attfilelist
                    },
                    function (e) {
                        layer.closeAll('loading');
                        if (e.Status == "Pass") {
                            callback();
                        } else {
                            layer.msg(e.Message,
                                {
                                    icon: 2,
                                    time: 3000
                                },
                                function () {
                                });
                        }
                    });
            }
            var addNotEmptyValid = function (filednames) {
                var files = filednames.split(',');
                for (var i = 0; i < files.length; i++) 
                    $("#CardStage").data('bootstrapValidator').addField(files[i], {
                        validators: {
                            notEmpty: {}
                        }
                    });                
            }
            var initPage = function() {
                self.parent.client.CallFunction("MESStation.Config.OnlineCardConfig", "GetSingelCardByCardNo", { CardNo: self.parent.selectedres.CARNO },
                    function (e) {
                        if (e.Status === "Pass") {
                            initlaydate();
                            cobj = e.Data[0];
                            loadFormBydata(e.Data[0]);
                            Createfiledownload();
                            var estatus = $('[lay-filter=ESTATUS]').val();
                            switch (estatus) {
                                case "1":
                                    $('#Summary :input').attr('disabled', 'disabled');
                                    $("#RootCause,#AddDept,#QC,#QA").hide();
                                    addNotEmptyValid('CONFIRMNAME');
                                    break;
                                case "2":
                                    $('#Summary :input,#PqeConfirm :input').attr('disabled', 'disabled');
                                    $("#AddDept,#QC,#QA").hide();
                                    addNotEmptyValid('ROOTPNAME,ROOTDEPART,FADATE');
                                    break;
                                case "3":
                                    $('#Summary :input,#PqeConfirm :input,#RootCause :input').attr('disabled', 'disabled');
                                    $("#QC,#QA").hide();
                                    break;
                                case "4":
                                    $('#Summary :input,#PqeConfirm :input,#RootCause :input,#AddDept :input').attr('disabled', 'disabled');
                                    addNotEmptyValid('QCPREPAREDDATE,QCPREPAREDBY,QCFAILPRODPROCESS');
                                    $("#QA").hide();
                                    break;
                                case "5":
                                    $('#Summary :input,#PqeConfirm :input,#RootCause :input,#AddDept :input,#QC :input').attr('disabled', 'disabled');
                                    addNotEmptyValid('REMARK,PROMIT,QAMANAGER,PROMITDATE');
                                    break;
                                case "6":
                                    $('#Summary :input,#PqeConfirm :input,#RootCause :input,#AddDept :input,#QC :input,#QA :input').attr('disabled', 'disabled');
                                    $("#Save").hide();
                                    break;
                                default: break;
                            }
                            for (var i = 1; i <= 5; i++)
                                if ($("[lay-filter=AUDITDEPART" + i + "]").val().length > 0)
                                    if ($("[lay-filter=AUDITDEPART" + i + "]").val() == CurrentUserDet.DPT_NAME
                                        || ($("[lay-filter=AUDITDEPART" + i + "]").val().indexOf("PROD") > -1 && CurrentUserDet.DPT_NAME.indexOf("PD") > -1) )
                                        addNotEmptyValid("MODIPART" +
                                            i +
                                            ',YCOMPLETEDDATE' +
                                            i +
                                            ',COMPLETEDDATE' +
                                            i +
                                            ',AUDITNAME' +
                                            i +
                                            ',COMPLETEDATE' +
                                            i);
                                    else {
                                        var inputobjs = $("[lay-filter=Dept"+i+" ] :input");
                                        for (var j = 0; j < inputobjs.length; j++) {
                                            inputobjs[j].disabled = true;
                                        }
                                    }
                                else
                                    $('[ lay-filter=Dept' + i).hide();
                            $('.filebtn').removeAttr("disabled");
                        } else {
                            layer.open({
                                type: 1,
                                skin: 'layui-layer-demo', //样式类名
                                closeBtn: 0, //不显示关闭按钮
                                anim: 2,
                                shadeClose: true, //开启遮罩关闭
                                content: e.Message
                            });
                            return;
                        }
                    });
            }
            var init = function () {
                self.parent.client.CallFunction("MESStation.Config.PublicConfig",
                    "GetCurrentUser", {},
                    function (e) {
                        if (e.Status === "Pass") {
                            CurrentUserDet = e.Data;
                            initPage();
                        } else {
                            layer.open({
                                type: 1,
                                skin: 'layui-layer-demo', //样式类名
                                closeBtn: 0, //不显示关闭按钮
                                anim: 2,
                                shadeClose: true, //开启遮罩关闭
                                content: e.Message
                            });
                            return;
                        }
                    });
            }
            var Createfiledownload = function () {
                var btns = "ATTACHFILE1,ATTACHFILE2,ATTACHFILE3".split(',');
                for (var i = 0; i < btns.length; i++) {
                    $("[lay-filter=" + btns[i]+"]").on("click", function () {
                        DownLoadFile(this.innerHTML,"OnlineCard");
                    })
                }
            }
            var b64toBlob = function (b64Data, sliceSize) {
                sliceSize = sliceSize || 512;
                var byteCharacters = atob(b64Data);
                var byteArrays = [];
                for (var offset = 0; offset < byteCharacters.length; offset += sliceSize) {
                    var slice = byteCharacters.slice(offset, offset + sliceSize);
                    var byteNumbers = new Array(slice.length);
                    for (var i = 0; i < slice.length; i++) {
                        byteNumbers[i] = slice.charCodeAt(i);
                    }
                    var byteArray = new Uint8Array(byteNumbers);
                    byteArrays.push(byteArray);
                }
                var blob = new Blob(byteArrays);
                return blob;
            };
            var DownLoadFile = function (name, usetype) {
                self.parent.client.CallFunction("MESStation.FileUpdate.FileUpload",
                    "FileDownLoadWithNameAndUseTypeByBrowser",
                    { "NAME": name, "USETYPE": usetype },
                    function (e) {
                        if (e.Status == "Pass") {
                            var blob = b64toBlob(e.Data.Content);
                            if (window.navigator.msSaveOrOpenBlob) {
                                navigator.msSaveBlob(blob, e.Data.FileName);
                            } else {
                                var link = document.createElement('a');
                                link.href = window.URL.createObjectURL(blob);
                                link.download = e.Data.FileName;
                                link.click();
                                window.URL.revokeObjectURL(link.href);
                            }
                        } else {
                            layer.msg(e.Message,
                                {
                                    icon: 2,
                                    time: 3000
                                },
                                function () { });
                            return;
                        }
                    });
            }
            $("#CardStage").bootstrapValidator({
                excluded: [':disabled', ':hidden', ':not(:visible)'],
                feedbackIcons: {
                    valid: 'glyphicon glyphicon-ok',
                    invalid: 'glyphicon glyphicon-remove',
                    validating: 'glyphicon glyphicon-refresh'
                },
                live: 'enabled',
                message: 'This value is not valid',
                fields: {
                    CARNO: {
                        validators: {
                            notEmpty: {}
                        }
                    },
                    CARTYPE: {
                        validators: {
                            notEmpty: {}
                        }
                    },
                    SKUNAME: {
                        validators: {
                            notEmpty: {}
                        }
                    },
                    SKUNO: {
                        validators: {
                            notEmpty: {}
                        }
                    },
                    PRODUCTIONLINE: {
                        validators: {
                            notEmpty: {}
                        }
                    },
                    STATION: {
                        validators: {
                            notEmpty: {}
                        }
                    },
                    FINDTIME: {
                        validators: {
                            notEmpty: {}
                        }
                    },
                    SKUQTY: {
                        validators: {
                            notEmpty: {},
                            regexp: {
                                regexp: /^\d+(\.\d+)?$/,
                                message: 'The value must be a number!'
                            }
                        }
                    },
                    FAILQTY: {
                        validators: {
                            notEmpty: {},
                            regexp: {
                                regexp: /^\d+(\.\d+)?$/,
                                message: 'The value must be a number!'
                            }
                        }
                    },
                    FAILPNAME: {
                        validators: {
                            notEmpty: {}
                        }
                    },
                    OKTORELEASE: {
                        validators: {
                            notEmpty: {},
                            regexp: {
                                regexp: /^\d+(\.\d+)?$/,
                                message: 'The value must be a number!'
                            }
                        }
                    }
                }
            });
            $('#FileUpload').change(function (ee) {
                var savefilename = $("#CARNO").val() + "ATTACHFILE1";
                cachefile(ee, savefilename, $('#FileUpload'), function () { cobj.ATTACHFILE1 = savefilename });
            });
            $('#CaFileUpload').change(function (ee) {
                var savefilename = $("#CARNO").val() + "ATTACHFILE2";
                cachefile(ee, savefilename, $('#CaFileUpload'), function () { cobj.ATTACHFILE2 = savefilename });
            });
            $('#QcFileUpload').change(function (ee) {
                var savefilename = $("#CARNO").val() + "ATTACHFILE3";
                cachefile(ee, savefilename, $('#QcFileUpload'), function () { cobj.ATTACHFILE3 = savefilename });
            });
            $("#Save").on("click", function () {
                var estatus = $('[lay-filter=ESTATUS]').val();
                switch (estatus) {
                    case "1":
                        if ($('[lay-filter=OKTORELEASE]').val() === "1")
                            addNotEmptyValid('FAILDEPART');
                        break;
                    case "2":
                        for (var i = 0; i < $('input[lay-filter=ROOTDEPART]:checked').length; i++) {
                            $('[lay-filter=AUDITDEPART' + (i + 1) + ']').val($('input[lay-filter=ROOTDEPART]:checked')[i].value);
                        }
                        break;
                    default: break;
                }

                $("#CardStage").data("bootstrapValidator").validate();
                var flag = $("#CardStage").data("bootstrapValidator").isValid();
                if (flag) {
                    cobj = loadfromdata(cobj);
                    saveFile(function () {
                        self.parent.client.CallFunction("MESStation.Config.OnlineCardConfig",
                            "EditCard", { Model: cobj },
                            function (e) {
                                if (e.Status === "Pass") {
                                    layer.msg("Success",
                                        {
                                            icon: 1,
                                            time: 1500
                                        },
                                        function () {
                                            var index = parent.layer.getFrameIndex(window.name);
                                            parent.LoadList();
                                            parent.layer.close(index);
                                        });
                                } else {
                                    layer.msg(e.Message,
                                        {
                                            icon: 2,
                                            time: 3000
                                        },
                                        function () {
                                        });
                                    return;
                                }
                            })
                    });
                }
            });
            init();
        });
    </script>
</body>
</html>